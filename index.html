<!DOCTYPE html>
<html lang="bar">
<head>
  <meta charset="UTF-8">
  <title>Oktoberfest‚ÄëAufgaben ‚Äì Barrierefrei mit Hauptsprache</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Zuf√§llige, barrierefreie Oktoberfest-Aufgaben mit w√§hlbarer Hauptsprache. Alle Sprachen werden angezeigt, die Hauptsprache gr√∂√üer.">
  <meta name="color-scheme" content="light dark">
  <style>
    /* ---------- Design: hell, freundlich, schlicht ---------- */
    :root {
      --bg-1: #f7fbff;
      --bg-2: #eff8ff;
      --fg: #1f2937;         /* neutral 800 */
      --fg-muted: #687385;   /* neutral 500-600 */
      --card-bg: #ffffff;
      --accent: #0a6cff;     /* Truma-Blau nah */
      --accent-2: #0bb37b;   /* Gr√ºn (Take-Button) */
      --chip-bg: rgba(10,108,255,.10);
      --shadow: 0 10px 30px rgba(15, 23, 42, .08);
      --radius: 16px;
      --focus: 3px solid #0a6cff;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-1: #0f172a;
        --bg-2: #0b1223;
        --fg: #e5edf7;
        --fg-muted: #a6b3c6;
        --card-bg: #0e1628;
        --accent: #7fb3ff;
        --accent-2: #58d3a0;
        --chip-bg: rgba(127,179,255,.14);
        --shadow: 0 12px 36px rgba(0,0,0,.45);
        --focus: 3px solid #7fb3ff;
      }
    }

    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--fg);
      line-height: 1.55;
      min-height: 100dvh;
      overflow-x: hidden;
      background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    /* ---------- Barrierefreiheit Hilfsklasse ---------- */
    .visually-hidden {
      position: absolute !important;
      width: 1px; height: 1px;
      margin: -1px; padding: 0; border: 0;
      clip: rect(0 0 0 0); clip-path: inset(50%);
      overflow: hidden; white-space: nowrap;
    }

    /* ---------- Hintergrund: sanft ziehende Bierkr√ºge ---------- */
    .bg-mugs {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: -1;
      opacity: .9;
    }
    .mug {
      position: absolute;
      top: var(--top, 20vh);
      left: -15vw;
      transform: translateX(-20vw) scale(var(--scale, 1));
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.08));
      animation: drift var(--dur, 48s) linear infinite;
      opacity: .18;
      font-size: calc(44px * var(--scale, 1));
      will-change: transform;
      user-select: none;
    }
    .mug::before { content: var(--emoji, 'üç∫'); display: block; }
    @keyframes drift { from { transform: translateX(-20vw) scale(var(--scale, 1)); } to { transform: translateX(120vw) scale(var(--scale, 1)); } }
    @media (prefers-reduced-motion: reduce) { .mug { display: none; } }

    /* ---------- Skip-Link ---------- */
    .skip-link {
      position: absolute; left: -9999px; top: auto; width: 1px; height: 1px; overflow: hidden;
    }
    .skip-link:focus {
      position: fixed; left: 12px; top: 12px; width: auto; height: auto;
      padding: .6rem .9rem; background: var(--card-bg); color: var(--fg);
      border-radius: 10px; box-shadow: var(--shadow); outline: var(--focus); z-index: 1000;
    }

    /* ---------- Layout ---------- */
    header, main, footer { max-width: 900px; margin: 0 auto; padding: 1rem; }
    header { padding-top: 2rem; }
    h1 { font-size: clamp(1.8rem, 2.4vw + 1rem, 2.8rem); margin: 0 0 .5rem 0; letter-spacing: .2px; }
    .sub { color: var(--fg-muted); font-size: clamp(1rem, .5vw + .9rem, 1.15rem); margin: 0; }

    /* ---------- Karte ---------- */
    .card {
      margin: 1.6rem 0 0;
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(1rem, 2.2vw + .6rem, 2rem);
      outline-offset: 4px;
      position: relative;
    }

    /* ---------- Aufgabe (Label oben, Text darunter) ---------- */
    .task {
      font-weight: 600;
      font-size: clamp(1.25rem, 1.6vw + 1rem, 2rem);
      line-height: 1.45;
      margin: .2rem 0 0 0;
    }
    .task .line { display: block; }
    .task .line + .line { margin-top: .9rem; }
    .task .line .tag {
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      padding: .16rem .6rem;
      border-radius: 999px;
      background: var(--chip-bg);
      font-weight: 800;
      letter-spacing: .2px;
      margin: 0 0 .35rem 0; /* abgesetzt √ºber dem Text */
    }
    .task .line .text { display: block; }
    .task .line .num { font-weight: 800; margin-right: .45rem; }
    .task .line.primary .text {
      font-size: clamp(1.45rem, 2.3vw + 1.05rem, 2.2rem);
      color: var(--fg);
    }
    .task .line.secondary .text {
      /* etwas gr√∂√üer als zuvor, aber kleiner als Prim√§rsprache */
      font-size: clamp(1.12rem, 1.1vw + 1rem, 1.32rem);
      color: var(--fg-muted);
    }

    /* ---------- Buttons ---------- */
    .controls { display: flex; flex-wrap: wrap; gap: .8rem; margin-top: 1.2rem; align-items: center; }
    button {
      appearance: none; -webkit-tap-highlight-color: transparent; border: none; border-radius: 14px;
      padding: 1rem 1.2rem; min-height: 44px; min-width: 44px;
      font-size: 1.05rem; font-weight: 700; letter-spacing: .2px; color: #fff;
      background: linear-gradient(135deg, var(--accent), #0463e6);
      box-shadow: 0 1px 0 rgba(255,255,255,.2) inset, 0 10px 20px rgba(0,0,0,.12);
      cursor: pointer; transition: transform .08s ease, box-shadow .2s ease, filter .2s ease;
    }
    button:hover { filter: brightness(1.06); }
    button:active { transform: translateY(1px) scale(.99); }
    button:focus-visible { outline: var(--focus); outline-offset: 3px; }
    .btn-secondary { background: linear-gradient(135deg, var(--accent-2), #0a8a64); }

    /* ---------- Sprach-Steuerung (nur Hauptsprache) ---------- */
    .lang-primary { display: grid; gap: .8rem; margin-top: 1rem; }
    fieldset {
      margin: 0; padding: .7rem .9rem .9rem; border: 1px solid rgba(0,0,0,.10);
      border-radius: 14px;
    }
    @media (prefers-color-scheme: dark) { fieldset { border-color: rgba(255,255,255,.12); } }
    legend { font-weight: 800; padding: 0 .4rem; }
    .options { display: flex; flex-wrap: wrap; gap: .6rem .9rem; margin-top: .4rem; }
    .options label {
      display: inline-flex; align-items: center; gap: .5rem; cursor: pointer;
      padding: .3rem .6rem; border-radius: 10px; background: transparent;
    }
    .options input { width: 1.1rem; height: 1.1rem; accent-color: var(--accent-2); }
    .hint { color: var(--fg-muted); font-size: .95rem; margin-top: .2rem; }

    /* ---------- Info ---------- */
    .help { display: grid; grid-template-columns: 1.4rem 1fr; gap: .6rem .8rem; align-items: start; margin-top: 1rem; color: var(--fg-muted); font-size: .98rem; }

    /* ---------- Task-Wechsel ---------- */
    .fade-enter { opacity: 0; transform: translateY(6px) scale(.995); }
    .fade-enter-active { opacity: 1; transform: translateY(0) scale(1); transition: opacity .38s ease, transform .38s ease; }
    @media (prefers-reduced-motion: reduce) { .fade-enter, .fade-enter-active { transition: none !important; transform: none !important; } }

    /* ---------- Konfetti (Gold/Wei√ü wie Bier/Schaum) ---------- */
    .confetti { position: fixed; inset: 0; pointer-events: none; z-index: 5; }
    .confetti .p { position: absolute; width: 10px; height: 10px; border-radius: 2px; opacity: .95; will-change: transform; animation: fall 1200ms ease-out forwards; }
    @keyframes fall { 0% { transform: translate(var(--x,0), -10vh) rotate(0deg); } 100% { transform: translate(var(--x-end,0), 92vh) rotate(720deg); } }
    @media (prefers-reduced-motion: reduce) { .confetti .p { display: none; } }

    footer { padding: 2rem 1rem 3rem; }
    .note { color: var(--fg-muted); font-size: .95rem; margin-top: .6rem; }

    /* ---------- Mobile Feinschliff ---------- */
    @media (max-width: 480px) {
      .task .line.secondary .text { font-size: 1.12rem; }
      .options label { padding: .45rem .6rem; }
    }
  </style>
</head>
<body>
  <!-- Hintergrund: sanft ziehende Bierkr√ºge -->
  <div class="bg-mugs" aria-hidden="true">
    <span class="mug" style="--top:10vh; --scale:1.0; --dur:52s; --emoji:'üç∫';"></span>
    <span class="mug" style="--top:22vh; --scale:.9;  --dur:58s; --emoji:'üçª';"></span>
    <span class="mug" style="--top:34vh; --scale:1.1; --dur:46s; --emoji:'üç∫';"></span>
    <span class="mug" style="--top:48vh; --scale:.8;  --dur:64s; --emoji:'üçª';"></span>
    <span class="mug" style="--top:60vh; --scale:1.0; --dur:50s; --emoji:'üç∫';"></span>
    <span class="mug" style="--top:72vh; --scale:.85; --dur:72s; --emoji:'üçª';"></span>
    <span class="mug" style="--top:84vh; --scale:1.2; --dur:54s; --emoji:'üç∫';"></span>
  </div>

  <a class="skip-link" href="#main" id="skiplink">Zum Inhalt springen</a>

  <header>
    <h1 id="heading">üçª Oktoberfest‚ÄëAufgabe</h1>
    <p class="sub" id="sub">Barrierefrei & mobilfreundlich. Alle Sprachen werden angezeigt ‚Äì die Hauptsprache gr√∂√üer.</p>
  </header>

  <main id="main" tabindex="-1">
    <section class="card" aria-labelledby="task-title">
      <h2 id="task-title" class="visually-hidden">Aktuelle Aufgabe</h2>

      <p id="task" class="task fade-enter" role="status" aria-live="polite" aria-atomic="true">‚Ä¶ l√§dt ‚Ä¶</p>

      <div class="controls" role="group" aria-label="Aufgabe steuern" id="controls-group">
        <button id="btn-new" type="button" class="btn-primary" aria-controls="task" title="Neue Aufgabe anzeigen (N)">
          Neue Aufgabe
        </button>
        <button id="btn-take" type="button" class="btn-secondary" aria-controls="task" title="Diese Aufgabe nehmen ‚Äì Z√§hler erh√∂hen" aria-live="polite">
          nehm ich
        </button>
        <span id="take-count-announce" class="visually-hidden" aria-live="polite"></span>
      </div>

      <!-- Hauptsprache w√§hlen (alle Sprachen werden immer gezeigt) -->
      <div class="lang-primary">
        <fieldset aria-labelledby="legend-primary">
          <legend id="legend-primary">Hauptsprache (wird gro√ü angezeigt)</legend>
          <div class="options" role="radiogroup" aria-label="Hauptsprache w√§hlen" id="primary-radiogroup">
            <label><input type="radio" name="primary" id="r-de" value="de"> <span id="lbl-de">Deutsch</span></label>
            <label><input type="radio" name="primary" id="r-en" value="en"> <span id="lbl-en">English</span></label>
            <label><input type="radio" name="primary" id="r-sv" value="sv"> <span id="lbl-sv">Swedish</span></label>
            <label><input type="radio" name="primary" id="r-bar" value="bar" checked> <span id="lbl-bar">Bavarian (Oberbairisch)</span></label>
          </div>
          <p class="hint" id="hint-primary">Alle Sprachen werden angezeigt. Die gew√§hlte Hauptsprache steht oben und ist gr√∂√üer.</p>
        </fieldset>
      </div>

      <div class="help" aria-live="off">
        <div aria-hidden="true">‚ÑπÔ∏è</div>
        <div id="help-text">
          Tastatur: N = neue Aufgabe. ‚Äûnehm ich‚Äú erh√∂ht euren Z√§hler. W√§hlt oben die Hauptsprache ‚Äì alle Sprachen werden darunter angezeigt.
        </div>
      </div>
    </section>

    <p class="note" id="note">
      Effekte ber√ºcksichtigen ‚ÄûBewegung reduzieren‚Äú. Kontraste erf√ºllen WCAG‚ÄëAA. Bedienelemente sind mindestens 44√ó44‚ÄØpx.
    </p>

    <noscript>
      <section class="card" aria-labelledby="fallback-title">
        <h2 id="fallback-title">Kein JavaScript aktiviert</h2>
        <p>W√§hle eine Aufgabe aus dieser nummerierten Liste:</p>
        <ol>
          <li>Erz√§hle in 30‚ÄØSekunden, warum das Oktoberfest das beste Fest der Welt ist.</li>
          <li>Sing die erste Strophe von ‚ÄûEin Prosit der Gem√ºtlichkeit‚Äú.</li>
          <li>Tausche deinen Sitzplatz mit jemandem, der einen Bollerwagen hat.</li>
          <li>Trinke einen Schluck Wasser und erkl√§re, warum Hydration wichtig ist.</li>
          <li>Erz√§hle einen kurzen Witz √ºber Brezn.</li>
          <li>Finde jemanden, der das Wort ‚ÄûBier‚Äú r√ºckw√§rts sagen kann.</li>
          <li>Mache ein Selfie mit einer Person im Trachtenhut und poste es (optional).</li>
          <li>Z√§hle bis 20 in einer fremden Sprache deiner Wahl.</li>
          <li>Zeige, wie man einen perfekten Ma√ükrug h√§lt ‚Äì und mache ein Foto davon.</li>
          <li>Mach ein Selfie mit der Person in sch√∂nster Tracht.</li>
        </ol>
      </section>
    </noscript>
  </main>

  <footer aria-label="Seitenende">
    <div class="note">Viel Spa√ü und Prost! Bitte respektvoll miteinander umgehen und aufeinander achten.</div>
  </footer>

  <div class="confetti" aria-hidden="true" id="confetti"></div>

  <script>
    // Aufgabeninhalte (DE/EN/SV/BAR)
    const tasksDe = [
      `Erz√§hle in 30‚ÄØSekunden, warum das Oktoberfest das beste Fest der Welt ist.`,
      `Sing die erste Strophe von ‚ÄûEin Prosit der Gem√ºtlichkeit‚Äú.`,
      `Tausche deinen Sitzplatz mit jemandem, der einen Bollerwagen hat.`,
      `Trinke einen Schluck Wasser und erkl√§re, warum Hydration wichtig ist.`,
      `Erz√§hle einen kurzen Witz √ºber Brezn.`,
      `Finde jemanden, der das Wort ‚ÄûBier‚Äú r√ºckw√§rts sagen kann.`,
      `Mache ein Selfie mit einer Person im Trachtenhut und poste es (optional).`,
      `Z√§hle bis 20 in einer fremden Sprache deiner Wahl.`,
      `Zeige, wie man einen perfekten Ma√ükrug h√§lt ‚Äì und mache ein Foto davon.`,
      `Mach ein Selfie mit der Person in sch√∂nster Tracht.`,
      `Gestaltet aus mindestens 3 Brezeln & Bierdeckeln eine kleine Skulptur und fotografiert das Ergebnis.`,
      `Sammle ein Gruppenfoto mit mindestens 5 Personen aus 5 verschiedenen Abteilungen.`,
      `Finde den kreativsten Hut im Festzelt.`,
      `Dreht ein 10‚Äì15‚ÄëSekunden‚ÄëVideo, in dem euer Tisch die Firma im Wiesn‚ÄëStil vorstellt (lustig/kreativ).`,
      `Prosit-Variante: Den n√§chsten Trinkspruch m√ºsst ihr in einer selbst erfundenen Sprache rufen.`,
      `Bayerisch f√ºr Anf√§nger: Einer am Tisch muss einen Satz nur auf Bayrisch versuchen (‚ÄûMia samma mia, und des is guad so!‚Äú).`,
      `Handyfreie Zone: F√ºr die n√§chsten 15 Minuten: Handy weg ‚Äì wer erwischt wird, muss den n√§chsten Trinkspruch anleiten.`,
      `Masskrug-Lippenlesen: Einer h√§lt den Ma√ükrug vor den Mund und sagt ein Wort ‚Äì die anderen m√ºssen es erraten`,
      `Fremde Freunde - Sprecht einen Nachbartisch an und ladet sie zu einem gemeinsamen ‚ÄûProst‚Äú ein.`,
      `O‚Äôzapft is! Lasst einen Fremden ‚ÄûO‚Äôzapft is!‚Äú rufen ‚Äì euer Tisch stimmt im Chor ein.`,
      `Brezn-Kunst -  Formt aus einer Brezn ein ‚ÄûKunstwerk‚Äú (Herz, Brille, etc.) und zeigt es rum.`,
      `Startet mit einem Oktoberfest-Wort (z.‚ÄØB. ‚ÄûMa√ü‚Äú). Der n√§chste muss ein Wort sagen, das mit dem letzten Buchstaben beginnt (‚ÄûSchnitzel‚Äú ‚Üí ‚ÄûLederhose‚Äú usw.).`,
      `Nach dem Essen: Jeder Tisch w√§hlt zwei Personen aus, die f√ºr 15 Minuten den Tisch wechseln und sich dort vorstellen.`,
      `Jeder erz√§hlt eine kurze Anekdote von einem fr√ºheren Oktoberfest ‚Äì ob peinlich, lustig oder √ºberraschend.`,
      `Was w√ºrdest du heute tun, wenn du keine Arbeit h√§ttest, nennt spontan eine Aktivit√§t, die er/sie heute machen w√ºrde?`,
      `Wiesn-ABC" Der Tisch bildet gemeinsam ein Alphabet mit Wiesn-Begriffen ‚Äì A wie ‚ÄûAnstich‚Äú, B wie ‚ÄûBrezn‚Äú, C wie ‚ÄûCurrywurst‚Äú usw.`,
      `Mache ein Selfie mit einem Value oder Leadership Ambassador.`,
      `Finde heraus, wer am Tisch am l√§ngsten im Unternehmen ist ‚Äì und wer am k√ºrzesten.`,
      `Finde drei Gemeinsamkeiten mit einer Kollegin/einem Kollegen.`,
      `Tausche dich mit jemandem √ºber eure Lieblingsorte in M√ºnchen aus.`,
      `Macht ein kleines Spiel: Wer kann am schnellsten ‚ÄûO‚Äôzapft is!‚Äú sagen?`,
      `Finde heraus, wer an Deinem Tisch am weitesten zur Arbeit pendelt.`,
      `Schreibt gemeinsam einen kleinen Oktoberfest-Gru√ü f√ºr die Kolleg:innen, die nicht dabei sein k√∂nnen.`,
      `Erz√§hle einem Kollegen eine lustige Anekdote aus deiner Ausbildungszeit.`,
      `Erfindet einen kurzen Wiesn-Slogan f√ºr euern Tisch.`,
      `Sammelt gemeinsam f√ºnf W√∂rter, die f√ºr euch #connectedness bedeuten.`,
      `Tauscht Euch dar√ºber aus, was ihr zuletzt neu gelernt habt.`,
      `Sprecht √ºber eure erste Erinnerung an das Unternehmen.`,
      `Startet eine ‚ÄûWiesn-Kettenfrage‚Äú: Jeder stellt dem n√§chsten eine Frage.`,
      `Macht ein ‚ÄûWiesn-Komplimentespiel‚Äú: Jeder gibt einem anderen ein ehrliches Kompliment.`,
      `Finde heraus, wer a bayrisches Lieblingswort hat ‚Äì und welches!`,
      `Frag jemanden, ob er lieber Brezn oder Obazdn mag ‚Äì und warum.`,
      `Fragt euch gegenseitig: ‚ÄûWas war dein erstes Wiesn-Erlebnis?‚Äú`,
      `Fragt euch gegenseitig: ‚ÄûWas macht f√ºr dich a gscheids Miteinand aus?‚Äú`,
      `Frag jemanden, ob er schon am Kocherlball war.`,
      `Mach ein Selfie mit jemandem, den du heute erst kennenglernt hast.`,
      `Mach ein Spiel: ‚ÄûWas w√ºrdest du tun, wenn du morgen Truma Group - CEO w√§rst?‚Äú`,
      `Eine Person von einem anderen Tisch muss zum Ansto√üen zum eigenen Tisch geholt werden.`,
      `Berichte dem Tisch: Was ist dein Lieblingsrestaurant in M√ºnchen?`,
      `Berichte deinem Tisch: Was ist deine Lieblingsbar in M√ºnchen?`,
      `Berichte deinem Tisch: Was ist dein Lieblingsclub in M√ºnchen?`,
      `Wer kann die Ma√ü mit ausgestreckten Arm l√§nger halten? Du oder dein Gegen√ºber?`,
      `Wie h√§lt man den Ma√ükrug richtig beim Ansto√üen und Trinken? - Wer wei√ü es`,
      `Deine erste Wiesn in deinem Leben? - Erz√§hle`,
      `Dein Wiesn Trauma - Erz√§hle`,
      `Lieblings-Farbe bei Dirndl oder Laiberl? √Ñhnlich Truma-Blau? ;-)`,
      `Wiesn-Frisuren-Highlight 2025? Foto?`,
      `Bist du a Winter-oder Sommercamper:in ?`
    ];
    const tasksEn = [
      `Tell in 30 seconds why Oktoberfest is the best festival in the world.`,
      `Sing the first verse of 'Ein Prosit der Gem√ºtlichkeit'.`,
      `Swap your seat with someone who has a handcart.`,
      `Take a sip of water and explain why hydration is important.`,
      `Tell a short joke about pretzels.`,
      `Find someone who can say the word 'Bier' backwards.`,
      `Take a selfie with a person wearing a traditional hat and post it (optional).`,
      `Count to 20 in a foreign language of your choice.`,
      `Show how to hold a perfect stein (Ma√ükrug) ‚Äî and take a photo of it.`,
      `Take a selfie with the person in the finest traditional outfit.`,
      `Create a small sculpture from at least 3 pretzels and beer coasters and photograph the result.`,
      `Collect a group photo with at least 5 people from 5 different departments.`,
      `Find the most creative hat in the festival tent.`,
      `Record a 10‚Äì15 second video where your table presents the company in Wiesn style (funny/creative).`,
      `Toast variant: For the next toast, you must shout in a made-up language.`,
      `Bavarian for beginners: Someone at the table must try a sentence only in Bavarian ('Mia samma mia, und des is guad so!').`,
      `Phone-free zone: For the next 15 minutes, phones away ‚Äî whoever gets caught must lead the next toast.`,
      `Stein lip-reading: One holds the stein in front of their mouth and says a word ‚Äî the others must guess it.`,
      `Friendly strangers: Talk to a neighboring table and invite them to a shared 'Prost'.`,
      `O‚Äôzapft is! Let a stranger shout 'O‚Äôzapft is!' ‚Äî your table joins in chorus.`,
      `Pretzel art: Shape a 'work of art' from a pretzel (heart, glasses, etc.) and show it around.`,
      `Start with an Oktoberfest word (e.g., 'Ma√ü'). The next person must say a word that begins with the last letter ('Schnitzel' ‚Üí 'Lederhose', etc.).`,
      `After eating: Each table selects two people who switch tables for 15 minutes and introduce themselves there.`,
      `Everyone tells a short anecdote from a previous Oktoberfest ‚Äî embarrassing, funny, or surprising.`,
      `What would you do today if you didn‚Äôt have work? Say one activity you‚Äôd do today.`,
      `Wiesn ABC: As a table, create an alphabet of Wiesn terms ‚Äî A for 'Anstich', B for 'Brezn', C for 'Currywurst', etc.`,
      `Take a selfie with a Value or Leadership Ambassador.`,
      `Find out who at the table has been at the company the longest ‚Äî and who the shortest.`,
      `Find three things you have in common with a colleague.`,
      `Exchange thoughts with someone about your favorite places in Munich.`,
      `Play a small game: Who can say 'O‚Äôzapft is!' the fastest?`,
      `Find out who at your table commutes the farthest to work.`,
      `Write together a short Oktoberfest greeting for the colleagues who can‚Äôt be there.`,
      `Tell a colleague a funny anecdote from your training/apprenticeship days.`,
      `Invent a short Wiesn slogan for your table.`,
      `Collect together five words that mean #connectedness to you.`,
      `Share what you learned most recently.`,
      `Talk about your first memory of the company.`,
      `Start a 'Wiesn question chain': Everyone asks the next person a question.`,
      `Play a Wiesn compliments game: Everyone gives someone else an honest compliment.`,
      `Find out who has a favorite Bavarian word ‚Äî and which one!`,
      `Ask someone whether they prefer pretzels or Obazda ‚Äî and why.`,
      `Ask each other: 'What was your first Wiesn experience?'`,
      `Ask each other: 'What makes a proper 'miteinand' for you?'`,
      `Ask someone whether they‚Äôve been to the Kocherlball.`,
      `Take a selfie with someone you met only today.`,
      `Play a game: 'What would you do if you were Truma Group CEO tomorrow?'`,
      `Bring a person from another table over to your table for a toast.`,
      `Tell the table: What is your favorite restaurant in Munich?`,
      `Tell your table: What is your favorite bar in Munich?`,
      `Tell your table: What is your favorite club in Munich?`,
      `Who can hold the Ma√ü with an outstretched arm longer ‚Äî you or your counterpart?`,
      `How do you hold the Ma√ükrug correctly when toasting and drinking ‚Äî who knows?`,
      `Your first Wiesn ever ‚Äî tell us.`,
      `Your Wiesn trauma ‚Äî tell us.`,
      `Favorite color for dirndl or shirt? Similar to Truma blue? ;-)`,
      `Wiesn hairstyle highlight 2025? Photo?`,
      `Are you a winter or summer camper?`
    ];
    const tasksSv = [
      `Ber√§tta p√• 30 sekunder varf√∂r Oktoberfest √§r v√§rldens b√§sta fest.`,
      `Sjung f√∂rsta versen av 'Ein Prosit der Gem√ºtlichkeit'.`,
      `Byt din sittplats med n√•gon som har en skrinda.`,
      `Drick en klunk vatten och f√∂rklara varf√∂r det √§r viktigt att vara hydrerad.`,
      `Ber√§tta ett kort sk√§mt om kringlor.`,
      `Hitta n√•gon som kan s√§ga ordet 'Bier' bakl√§nges.`,
      `Ta en selfie med n√•gon i dr√§kthatt och posta den (valfritt).`,
      `R√§kna till 20 p√• ett fr√§mmande spr√•k du v√§ljer.`,
      `Visa hur man h√•ller en perfekt √∂lsejdel ‚Äî och ta ett foto av det.`,
      `Ta en selfie med personen i finaste dr√§kt.`,
      `Skapa en liten skulptur av minst 3 kringlor och √∂lunderl√§gg och fota resultatet.`,
      `Ta ett gruppfoto med minst 5 personer fr√•n 5 olika avdelningar.`,
      `Hitta den mest kreativa hatten i festt√§ltet.`,
      `Spela in en 10‚Äì15 sekunders video d√§r ert bord presenterar f√∂retaget i Wiesn-stil (roligt/kreativt).`,
      `Sk√•l-variant: Vid n√§sta sk√•l m√•ste ni ropa p√• ett p√•hittat spr√•k.`,
      `Bayerska f√∂r nyb√∂rjare: N√•gon vid bordet ska f√∂rs√∂ka s√§ga en mening bara p√• bayerska ('Mia samma mia, und des is guad so!').`,
      `Mobilfri zon: I 15 minuter fram√•t ‚Äì bort med mobilerna; den som ertappas m√•ste leda n√§sta sk√•l.`,
      `Ma√ükrug-l√§ppavl√§sning: N√•gon h√•ller sejdeln framf√∂r munnen och s√§ger ett ord ‚Äì de andra m√•ste gissa.`,
      `Fr√§mmande v√§nner ‚Äì Prata med ett grannbord och bjud in dem till en gemensam 'Prost'.`,
      `O‚Äôzapft is! L√•t en fr√§mling ropa 'O‚Äôzapft is!' ‚Äì ert bord st√§mmer in i k√∂r.`,
      `Brezel-konst ‚Äì Forma ett 'konstverk' av en brezel (hj√§rta, glas√∂gon, etc.) och visa runt.`,
      `B√∂rja med ett Oktoberfest-ord (t.ex., 'Ma√ü'). N√§sta m√•ste s√§ga ett ord som b√∂rjar p√• sista bokstaven ('Schnitzel' ‚Üí 'Lederhose' osv.).`,
      `Efter maten: Varje bord v√§ljer tv√• personer som byter bord i 15 minuter och presenterar sig d√§r.`,
      `Alla ber√§ttar en kort anekdot fr√•n en tidigare Oktoberfest ‚Äì pinsam, rolig eller √∂verraskande.`,
      `Vad skulle du g√∂ra idag om du inte hade jobb? S√§g spontant en aktivitet du skulle g√∂ra idag.`,
      `Wiesn-ABC: Bordet tar fram ett alfabet med Wiesn-begrepp ‚Äì A som 'Anstich', B som 'Brezn', C som 'Currywurst' osv.`,
      `Ta en selfie med en Value- eller Leadership Ambassador.`,
      `Ta reda p√• vem vid bordet som varit l√§ngst p√• f√∂retaget ‚Äì och vem kortast tid.`,
      `Hitta tre saker du har gemensamt med en kollega.`,
      `Prata med n√•gon om era favoritplatser i M√ºnchen.`,
      `G√∂r en liten lek: Vem kan s√§ga 'O‚Äôzapft is!' snabbast?`,
      `Ta reda p√• vem vid ditt bord som pendlar l√§ngst till jobbet.`,
      `Skriv tillsammans en kort Oktoberfest-h√§lsning till kollegorna som inte kan vara med.`,
      `Ber√§tta f√∂r en kollega en rolig anekdot fr√•n din utbildningstid.`,
      `Hitta p√• en kort Wiesn-slogan f√∂r ert bord.`,
      `Samla tillsammans fem ord som betyder #connectedness f√∂r er.`,
      `Utbyt vad ni senast l√§rde er.`,
      `Prata om ert f√∂rsta minne av f√∂retaget.`,
      `Starta en 'Wiesn-fr√•gekedja': Var och en st√§ller en fr√•ga till n√§sta.`,
      `G√∂r en 'Wiesn-komplimentslek': Alla ger n√•gon annan en √§rlig komplimang.`,
      `Ta reda p√• vem som har ett bayerskt favoritord ‚Äì och vilket!`,
      `Fr√•ga n√•gon om hen f√∂redrar kringlor eller obatzda ‚Äì och varf√∂r.`,
      `Fr√•ga varandra: 'Vad var din f√∂rsta Wiesn-upplevelse?'`,
      `Fr√•ga varandra: 'Vad √§r ett riktigt bra samspel f√∂r dig?'`,
      `Fr√•ga n√•gon om hen har varit p√• Kocherlball.`,
      `Ta en selfie med n√•gon du l√§rt k√§nna idag.`,
      `Lek: 'Vad skulle du g√∂ra om du var Truma Group-vd i morgon?'`,
      `H√§mta en person fr√•n ett annat bord till ert bord f√∂r en sk√•l.`,
      `Ber√§tta f√∂r bordet: Vilken √§r din favoritrestaurang i M√ºnchen?`,
      `Ber√§tta f√∂r bordet: Vilken √§r din favoritbar i M√ºnchen?`,
      `Ber√§tta f√∂r bordet: Vilken √§r din favoritklubb i M√ºnchen?`,
      `Vem kan h√•lla en Ma√ü med utstr√§ckt arm l√§ngst ‚Äì du eller din motpart?`,
      `Hur h√•ller man Ma√ükrugen r√§tt n√§r man sk√•lar och dricker ‚Äì vem vet?`,
      `Din f√∂rsta Wiesn n√•gonsin ‚Äì ber√§tta.`,
      `Ditt Wiesn-trauma ‚Äì ber√§tta.`,
      `Favoritf√§rg p√• dirndl eller tr√∂ja? Liknar den Truma-bl√•? ;-)`,
      `Wiesn-frisyr-highlight 2025? Foto?`,
      `√Ñr du vinter- eller sommarcampare?`
    ];
    const tasksBar = [
      `Erz√§hl in 30 Sekunden, warum d‚ÄôWiesn des beste Fest auf da Welt is.`,
      `Sing d‚Äô erste Strof vo 'Ein Prosit der Gm√ºtlichkeit'.`,
      `Tausch dei Sitzplatz mit am, der a Bollerwagen hod.`,
      `Trink a Schluck Wossa und erkl√§r, warum‚Äôs wichtig is, dass ma gscheid hydriert bleibt.`,
      `Erz√§hl a kurzen Witz √ºber Brezn.`,
      `Find an, der des Woid 'Bia' r√ºckw√§rts sogn ko.`,
      `Mach a Selfie mit am mit am Trachtnhuad und post‚Äôs (optional).`,
      `Z√§hl bis 20 in ana fremdn Sproch deina Wahl.`,
      `Zeig, wia ma a Ma√ü gscheid hoit ‚Äì und moch a Foto davo.`,
      `Mach a Selfie mit da Person in da scheenstn Tracht.`,
      `Bastelts aus mindesdens 3 Brezn und Bierdeckn a kloane Skulptur und fotografiert‚Äôs Ergebnis.`,
      `Sammelt a Gruppenfoto mit mindesdens 5 Leit aus 5 verschieden Abteilungan.`,
      `Find den kreativstn Huad im Festzelt.`,
      `Dreht a 10‚Äì15‚ÄëSekundn‚ÄëVideo, in dem eia Tisch d‚ÄôFirma im Wiesn‚ÄëStil vorstellt (lustig/kreativ).`,
      `Prosit‚ÄëVariante: Beim n√§chsten Ansto√ün mua√üts in ana aus‚Äôdachdn Sproch roa.`,
      `Boarisch fia Anfanga: Oana am Tisch mua√ü an Satz nur auf Boarisch probiern ('Mia samma mia, und des is guad so!').`,
      `Handyfreie Zone: De n√§chsten 15 Minutn‚Äôs Handy weg ‚Äì wea erwischt werd, mua√ü‚Äôn n√§chsten Trinkspruch o‚Äôleiten.`,
      `Ma√ükrug‚ÄëLippnlesn: Oana hoit d‚ÄôMa√ü vor d‚ÄôGoschn und sogt a Woid ‚Äì de andern miassn‚Äôs erratn.`,
      `Fremde Freind ‚Äì Sprecht‚Äôs an Nachbartisch o und ladts‚Äôs zua am gmeinsamen 'Prost' ei.`,
      `O‚Äôzapft is! Lassds an Fremdn 'O‚Äôzapft is!' rua ‚Äì eia Tisch stimmt im Chor ei.`,
      `Brezn‚ÄëKunsd ‚Äì Formts aus ana Brezn a 'Kunstwerk' (Herz, Bria, etc.) und zeigts‚Äôs rum.`,
      `Fangts mit am Wiesn‚ÄëWoid o (z.‚ÄØB. 'Ma√ü'). Da N√§chste mua√ü a Woid sogn, des mit‚Äôm letztn Buachstabe anf√§ngt ('Schnitzel' ‚Üí 'Lederhosn' usw.).`,
      `Nochm Essen: Jeda Tisch suacht zwoa Leit aus, de 15 Minutn an Tisch wechsln und si dort virstelln.`,
      `Jeda erz√§hld a kloans Gschichtl vo ana fr√ºheren Wiesn ‚Äì peinlich, lustig oda √ºberraschend.`,
      `Wos dadst heit macha, wennst koa Orbeit h√§ttst? Sog spontan a Sach, de‚Äôd heit macha dadst.`,
      `Wiesn‚ÄëABC: Bildts zsam a Alphabet mit Wiesn‚ÄëBegriff ‚Äì A wia 'Anstich', B wia 'Brezn', C wia 'Currywurst' usw.`,
      `Mach a Selfie mit am Value‚Äë oder Leadership Ambassador.`,
      `Finds aus, wea an Tisch am l√§ngsten bei da Firma is ‚Äì und wea am k√ºrzestn.`,
      `Find drei Gmeinsamkeidn mit ana Kollegin/am Kollegen.`,
      `Ratsch mit jemand √ºber eire Lieblingsplatzerl in Minga.`,
      `Macht a kloans Spui: Wer ko 'O‚Äôzapft is!' am schnellstn sogn?`,
      `Finds aus, wea an eiam Tisch am weitestn in d‚ÄôOrbeit pendelt.`,
      `Schreibts zsam an kloana Wiesn‚ÄëGrua√ü fia d‚ÄôKolleg‚Äôn, de net dabei sei kenna.`,
      `Erz√§hl am Kollegen a lustigs Gschichtl aus da Lehrzeit.`,
      `Erfindts an kurn Wiesn‚ÄëSlogan fia eiern Tisch.`,
      `Sammelts zsam f√ºnf W√∂d, de fia eich #connectedness bedeitn.`,
      `Ratschts dr√ºber, wos ihr zletzt neiglernt habts.`,
      `Redts √ºber eia erste Erinnerung an d‚ÄôFirma.`,
      `Fangts a 'Wiesn‚ÄëKettenfrog' o: Jeda stellt‚Äôm N√§chsten a Frog.`,
      `Macht a 'Wiesn‚ÄëKompliment‚ÄëSpui': Jeda gibt am Andern a ehrlichs Kompliment.`,
      `Finds aus, wea a boarischs Lieblingswort hod ‚Äì und welchs!`,
      `Frag an, ob a liawa Brezn oda Obazdn mog ‚Äì und warum.`,
      `Frogt‚Äôs eich: 'Wos war dei erste Wiesn‚ÄëErlebnis?'`,
      `Frogt‚Äôs eich: 'Wos macht fia di a gscheids Miteinand aus?'`,
      `Frag an, ob a scho am Kocherlball war.`,
      `Mach a Selfie mit am, denst heit erst kennenglernt host.`,
      `Spui: 'Wos dadst du macha, wennst morgn Truma Group‚ÄëCEO warst?'`,
      `Holt‚Äôs a Person vo am andern Tisch her f√ºrn Asto√ün.`,
      `Bericht‚Äôm Tisch: Wos is dei Lieblingswirtshaus in Minga?`,
      `Bericht‚Äôm Tisch: Wos is dei Lieblingsbar in Minga?`,
      `Bericht‚Äôm Tisch: Wos is dei Lieblingsclub in Minga?`,
      `Wer ko d‚ÄôMa√ü mit ausgstrecktem Oam l√§nga hoitn ‚Äì du oda dei Gegen√ºber?`,
      `Wia hoit ma d‚ÄôMa√ü richtig beim Asto√ün und Tringa ‚Äì wea woa√ü‚Äôs?`,
      `Dei erste Wiesn in dei‚Äôm Leb‚Äôn ‚Äì erz√§hl!`,
      `Dei Wiesn‚ÄëTrauma ‚Äì erz√§hl!`,
      `Liabste Farb beim Dirndl oder Laiberl? A bissl wia‚Äôs Truma‚ÄëBlao? ;-)`,
      `Wiesn‚ÄëFrisurn‚ÄëHighlight 2025? Foto?`,
      `Bist a Winter‚Äë oda Sommer‚ÄëCamper/in?`
    ];

    // UI-Strings (i18n)
    const UI = {
      de: {
        title: 'Oktoberfest‚ÄëAufgaben ‚Äì Barrierefrei mit Hauptsprache',
        h1: 'üçª Oktoberfest‚ÄëAufgabe',
        sub: 'Barrierefrei & mobilfreundlich. Alle Sprachen werden angezeigt ‚Äì die Hauptsprache gr√∂√üer.',
        skipLink: 'Zum Inhalt springen',
        taskTitle: 'Aktuelle Aufgabe',
        btnNew: 'Neue Aufgabe',
        btnNewTitle: 'Neue Aufgabe anzeigen (N)',
        btnTake: 'nehm ich',
        btnTakeTitle: 'Diese Aufgabe nehmen ‚Äì Z√§hler erh√∂hen',
        legendPrimary: 'Hauptsprache (wird gro√ü angezeigt)',
        hintPrimary: 'Alle Sprachen werden angezeigt. Die gew√§hlte Hauptsprache steht oben und ist gr√∂√üer.',
        radioGroupAria: 'Hauptsprache w√§hlen',
        help: 'Tastatur: N = neue Aufgabe. ‚Äûnehm ich‚Äú erh√∂ht euren Z√§hler. W√§hlt oben die Hauptsprache ‚Äì alle Sprachen werden darunter angezeigt.',
        note: 'Effekte ber√ºcksichtigen ‚ÄûBewegung reduzieren‚Äú. Kontraste erf√ºllen WCAG‚ÄëAA. Bedienelemente sind mindestens 44√ó44‚ÄØpx.',
        takeAria: (n)=>`Nehm ich. Z√§hler: ${n}`,
        langTags: { de:'Deutsch', en:'English', sv:'Swedish', bar:'Bairisch' },
        langLabels: { de:'Deutsch', en:'Englisch', sv:'Schwedisch', bar:'Bairisch (Oberbairisch)' }
      },
      en: {
        title: 'Oktoberfest tasks ‚Äì Accessible with primary language',
        h1: 'üçª Oktoberfest task',
        sub: 'Accessible & mobile‚Äëfriendly. All languages are shown ‚Äì the primary one is larger.',
        skipLink: 'Skip to content',
        taskTitle: 'Current task',
        btnNew: 'New task',
        btnNewTitle: 'Show new task (N)',
        btnTake: 'I‚Äôll take it',
        btnTakeTitle: 'Take this task ‚Äì increase counter',
        legendPrimary: 'Primary language (shown larger)',
        hintPrimary: 'All languages are displayed. The chosen primary language appears first and larger.',
        radioGroupAria: 'Choose primary language',
        help: 'Keyboard: N = new task. ‚ÄúI‚Äôll take it‚Äù increases your counter. Choose the primary language above ‚Äì all languages are shown below.',
        note: 'Effects honor ‚Äúreduce motion‚Äù. Contrast meets WCAG‚ÄëAA. Controls are at least 44√ó44 px.',
        takeAria: (n)=>`I‚Äôll take it. Counter: ${n}`,
        langTags: { de:'German', en:'English', sv:'Swedish', bar:'Bavarian' },
        langLabels: { de:'German', en:'English', sv:'Swedish', bar:'Bavarian (Upper Bavarian)' }
      },
      sv: {
        title: 'Oktoberfest‚Äëuppgifter ‚Äì Tillg√§nglig med huvudspr√•k',
        h1: 'üçª Oktoberfest‚Äëuppgift',
        sub: 'Tillg√§nglig och mobilv√§nlig. Alla spr√•k visas ‚Äì huvudspr√•ket visas st√∂rre.',
        skipLink: 'Hoppa till inneh√•ll',
        taskTitle: 'Aktuell uppgift',
        btnNew: 'Ny uppgift',
        btnNewTitle: 'Visa ny uppgift (N)',
        btnTake: 'Jag tar den',
        btnTakeTitle: 'Ta uppgiften ‚Äì √∂ka r√§knaren',
        legendPrimary: 'Huvudspr√•k (visas st√∂rre)',
        hintPrimary: 'Alla spr√•k visas. Valda huvudspr√•k visas f√∂rst och st√∂rre.',
        radioGroupAria: 'V√§lj huvudspr√•k',
        help: 'Tangentbord: N = ny uppgift. ‚ÄùJag tar den‚Äù √∂kar r√§knaren. V√§lj huvudspr√•k ovan ‚Äì alla spr√•k visas nedan.',
        note: 'Effekter respekterar ‚Äùminska r√∂relse‚Äù. Kontrast uppfyller WCAG‚ÄëAA. Kontroller √§r minst 44√ó44 px.',
        takeAria: (n)=>`Jag tar den. R√§knare: ${n}`,
        langTags: { de:'Tyska', en:'Engelska', sv:'Svenska', bar:'Bayerska' },
        langLabels: { de:'Tyska', en:'Engelska', sv:'Svenska', bar:'Bayerska (Oberbairisch)' }
      },
      bar: {
        title: 'Wiesn‚ÄëAufgab‚Äôn ‚Äì Barrierefrei mit Hauptsproch',
        h1: 'üçª Wiesn‚ÄëAufgab‚Äôn',
        sub: 'Barrierefrei und f√ºrs Handy guad. Olle Sprochn werd‚Äôn zeigt ‚Äì d‚Äô Hauptsproch is gr√∂ssa.',
        skipLink: 'Zum Inhalt springa',
        taskTitle: 'Aktuelle Aufgab‚Äôn',
        btnNew: 'Neue Aufgab‚Äôn',
        btnNewTitle: 'Neue Aufgab‚Äôn zoang (N)',
        btnTake: 'nehm i',
        btnTakeTitle: 'Aufgab‚Äôn nehma ‚Äì Z√§hler erh√∂hn',
        legendPrimary: 'Hauptsproch (gro√ü)',
        hintPrimary: 'Olle Sprochn werd‚Äôn zeigt. D‚Äô Hauptsproch kimmt z‚Äôerst und is gr√∂ssa.',
        radioGroupAria: 'Hauptsproch aussuach‚Äôn',
        help: 'Tastatur: N = neue Aufgab‚Äôn. ‚Äûnehm i‚Äú erh√∂ht‚Äôn Z√§hler. Suachd ob‚Äôn d‚Äô Hauptsproch ‚Äì olle Sprochn steh‚Äôn drunta.',
        note: 'Effekt respektiern ‚Äûweniga Bewegung‚Äú. Kontrast passt (WCAG‚ÄëAA). Bedienelement‚Äô san mind. 44√ó44 px.',
        takeAria: (n)=>`nehm i. Z√§hler: ${n}`,
        langTags: { de:'Deitsch', en:'Englisch', sv:'Schwedisch', bar:'Boarisch' },
        langLabels: { de:'Deitsch', en:'Englisch', sv:'Schwedisch', bar:'Boarisch (Oberboarisch)' }
      }
    };

    // Referenzen UI
    const docEl = document.documentElement;
    const skiplink = document.getElementById('skiplink');
    const heading = document.getElementById('heading');
    const sub = document.getElementById('sub');
    const taskTitleEl = document.getElementById('task-title');
    const taskEl = document.getElementById('task');
    const btnNew = document.getElementById('btn-new');
    const btnTake = document.getElementById('btn-take');
    const legendPrimary = document.getElementById('legend-primary');
    const rg = document.getElementById('primary-radiogroup');
    const hintPrimary = document.getElementById('hint-primary');
    const helpText = document.getElementById('help-text');
    const note = document.getElementById('note');
    const takeAnnounce = document.getElementById('take-count-announce');

    // Radio-Labels
    const lblDe = document.getElementById('lbl-de');
    const lblEn = document.getElementById('lbl-en');
    const lblSv = document.getElementById('lbl-sv');
    const lblBar = document.getElementById('lbl-bar');

    // Radios
    const rDe = document.getElementById('r-de');
    const rEn = document.getElementById('r-en');
    const rSv = document.getElementById('r-sv');
    const rBar = document.getElementById('r-bar');

    const LANGS = ['de','en','sv','bar'];
    const arrays = { de: tasksDe, en: tasksEn, sv: tasksSv, bar: tasksBar };

    let lastIndex = -1;
    let takeCount = 0;

    // Default-Hauptsprache: Bairisch
    let primary = 'bar';

    // Storage-Key (neu), damit Default greift, auch wenn alte Auswahl existiert
    const STORAGE_KEY = 'wiesnPrefsDesignBar';

    // Load saved preferences
    try {
      const saved = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
      if (saved && typeof saved.takeCount === 'number') takeCount = saved.takeCount;
      if (saved && typeof saved.primary === 'string' && LANGS.includes(saved.primary)) primary = saved.primary;
    } catch {}

    // Apply checked radio
    ({ de: rDe, en: rEn, sv: rSv, bar: rBar })[primary].checked = true;

    function savePrefs() { try { localStorage.setItem(STORAGE_KEY, JSON.stringify({ takeCount, primary })); } catch {} }

    function setTaskHTML(html) {
      taskEl.classList.remove('fade-enter-active');
      taskEl.classList.add('fade-enter');
      void taskEl.offsetWidth; // Reflow
      taskEl.innerHTML = html;
      taskEl.classList.add('fade-enter-active');
      requestAnimationFrame(() => taskEl.classList.remove('fade-enter'));
    }

    function getRandomIndex() {
      const len = arrays[primary].length;
      if (len === 1) return 0;
      let idx;
      do { idx = Math.floor(Math.random() * len); } while (idx === lastIndex);
      return idx;
    }

    function languageOrderAll() {
      const others = LANGS.filter(l => l !== primary);
      return [primary, ...others];
    }

    function renderTask(idx) {
      const t = UI[primary];
      const num = `${idx + 1}.`;
      const order = languageOrderAll();
      const parts = [];

      const tagNames = t.langTags;

      for (const lang of order) {
        const isPrimary = lang === primary;
        const cls = isPrimary ? 'primary' : 'secondary';
        const label = tagNames[lang];
        const text = arrays[lang][idx];
        const langAttr = lang;

        if (isPrimary) {
          parts.push(
            `<span class="line ${cls}" lang="${langAttr}">
               <span class="tag">${label}</span>
               <span class="text"><span class="num">${num}</span>${text}</span>
             </span>`
          );
        } else {
          parts.push(
            `<span class="line ${cls}" lang="${langAttr}">
               <span class="tag">${label}</span>
               <span class="text">${text}</span>
             </span>`
          );
        }
      }

      setTaskHTML(parts.join(''));
    }

    function newTask() {
      const idx = getRandomIndex();
      lastIndex = idx;
      renderTask(idx);
      burstConfetti();
    }

    function updateTakeButton() {
      const t = UI[primary];
      btnTake.textContent = `${t.btnTake} (${takeCount})`;
      btnTake.setAttribute('aria-label', t.takeAria(takeCount));
      takeAnnounce.textContent = t.takeAria(takeCount);
    }

    function takeTask() { takeCount += 1; updateTakeButton(); savePrefs(); }

    function applyUI() {
      const t = UI[primary];
      docEl.lang = primary;
      document.title = t.title;
      skiplink.textContent = t.skipLink;
      heading.textContent = t.h1;
      sub.textContent = t.sub;
      taskTitleEl.textContent = t.taskTitle;
      btnNew.textContent = t.btnNew;
      btnNew.title = t.btnNewTitle;
      btnTake.title = t.btnTakeTitle;
      updateTakeButton();
      legendPrimary.textContent = t.legendPrimary;
      hintPrimary.textContent = t.hintPrimary;
      rg.setAttribute('aria-label', t.radioGroupAria);
      lblDe.textContent = t.langLabels.de;
      lblEn.textContent = t.langLabels.en;
      lblSv.textContent = t.langLabels.sv;
      lblBar.textContent = t.langLabels.bar;
      helpText.textContent = t.help;
      note.textContent = t.note;
      if (lastIndex >= 0) renderTask(lastIndex);
    }

    function onPrimaryChange(newPrimary) { primary = newPrimary; savePrefs(); applyUI(); }

    // Wire up radios
    rDe.addEventListener('change', (e) => { if (e.target.checked) onPrimaryChange('de'); });
    rEn.addEventListener('change', (e) => { if (e.target.checked) onPrimaryChange('en'); });
    rSv.addEventListener('change', (e) => { if (e.target.checked) onPrimaryChange('sv'); });
    rBar.addEventListener('change', (e) => { if (e.target.checked) onPrimaryChange('bar'); });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.altKey || e.ctrlKey || e.metaKey) return;
      if (e.key.toLowerCase() === 'n') { e.preventDefault(); btnNew.click(); }
    });

    // Konfetti (Gold/Wei√ü/Amber)
    const confettiEl = document.getElementById('confetti');
    function burstConfetti() {
      const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
      if (mediaQuery.matches) return;
      const count = 24;
      const colors = ['#ffd166', '#ffb703', '#ffe8a3', '#ffffff', '#e0a800'];
      const { innerWidth: W } = window;
      confettiEl.textContent = '';
      for (let i = 0; i < count; i++) {
        const p = document.createElement('span');
        p.className = 'p';
        const x = Math.random() * W;
        const drift = (Math.random() * 160 - 80);
        p.style.left = `${x}px`;
        p.style.setProperty('--x', `${0}px`);
        p.style.setProperty('--x-end', `${drift}px`);
        p.style.background = colors[i % colors.length];
        confettiEl.appendChild(p);
      }
      setTimeout(() => { confettiEl.textContent = ''; }, 1300);
    }

    btnNew.addEventListener('click', newTask);
    btnTake.addEventListener('click', takeTask);

    // Initialisieren
    window.addEventListener('load', () => {
      applyUI();
      newTask();
    });
  </script>
</body>
</html>
